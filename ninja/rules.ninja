include $include_dir/chips/$chip.ninja
include $include_dir/toolchains/$toolchain.ninja

cflags = $common_cflags -march=$arch -mcpu=$cpu $target_extra_cflags $
         $toolchain_cflags

gcc = ./toolchains/$toolchain/out/bin/${toolchain}-gcc

rule cc
  depfile = $out.d
  deps = gcc
  command = $gcc -MD -MF $out.d $cflags -c $in -o $out

ldflags = -T$include_dir/chips/$chip.ld

rule link
  command = $gcc $cflags $ldflags $in -o $out

build_dir = build/$toolchain/$arch/$cpu
